<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 2.3//EN" "http://struts.apache.org/dtds/struts-2.3.dtd">
<struts>

    <include file="struts-hornet-hornetserver.xml" />

    <constant name="struts.url.includeParams" value="none" />
    <constant name="struts.custom.i18n.resources"
        value="fr.gouv.diplomatie.applitutoriel.business.messages,fr.gouv.diplomatie.applitutoriel.web.action.package,package" />
    <constant name="struts.ui.theme" value="applitutoriel" />
    <constant name="struts.date.format" value="dd/MM/yyyy" />

    <package name="struts-hornet-applitutoriel" extends="struts-hornet-hornetserver">

        <interceptors>
            <interceptor name="userContextInterceptor"
                class="fr.gouv.diplomatie.applitutoriel.web.interceptor.UserContextInterceptor" />
            <interceptor name="conversionFieldErrorInterceptor"
                class="fr.gouv.diplomatie.applitutoriel.web.interceptor.ConversionFieldErrorInterceptor" />
            <interceptor-stack name="applitutoriel-stack">
                <interceptor-ref name="userContextInterceptor" />
                <interceptor-ref name="conversionFieldErrorInterceptor" />
                <interceptor-ref name="hornet-hijaxresult" />
                <interceptor-ref name="hornet-stack" />
            </interceptor-stack>
        </interceptors>
        <default-interceptor-ref name="applitutoriel-stack" />
        <global-results>
            <result name="error" type="tiles">actionError</result>
            <result name="input" type="tiles">actionError</result>
            <result name="success.xml" type="dispatcher">
                <param name="location">/WEB-INF/xml-jsp/commun/success.jsp</param>
            </result>
            <result name="error.xml" type="dispatcher">
                <param name="location">/WEB-INF/xml-jsp/commun/error.jsp</param>
            </result>
            <result name="input.xml" type="dispatcher">
                <param name="location">/WEB-INF/xml-jsp/commun/error.jsp</param>
            </result>
        </global-results>
    </package>

    <package name="fr.gouv.diplomatie.applitutoriel.web.action.frameset" namespace="/dyn/protected/frameset"
        extends="struts-hornet-applitutoriel">
        <action name="index">
            <result name="success" type="redirect">
                <param name="location">/index.jsp</param>
            </result>
        </action>
        <action name="logout" class="fr.gouv.diplomatie.applitutoriel.web.action.frameset.Logout">
            <result name="success" type="redirect">
                <param name="location">${location}</param>
            </result>
        </action>
    </package>

    <package name="fr.gouv.diplomatie.applitutoriel.web.action.base" namespace="/dyn/protected"
        extends="struts-hornet-applitutoriel">
        <action name="accueil">
            <result name="success" type="tiles">accueil</result>
        </action>
        <action name="accessibilite">
            <result name="success" type="tiles">accessibilite</result>
        </action>
        <action name="aide">
            <result name="success" type="tiles">aide</result>
        </action>
        <action name="planSite">
            <result name="success" type="tiles">planSite</result>
        </action>
    </package>

    <package name="partenaires" namespace="/dyn/protected/partenaire"
        extends="struts-hornet-applitutoriel">

        <!-- RECHERCHE PARTENAIRE -->
        <action name="formRecherche"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.RecherchePartenaire"
            method="initRecherche">
            <interceptor-ref name="scope">
                <param name="session">criteres</param>
                <param name="type">start</param>
            </interceptor-ref>
            <interceptor-ref name="scope">
                <param name="session">tablesStates</param>
                <param name="type">start</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">recherchePartenaire</result>
            <result name="error" type="tiles">recherchePartenaireError</result>
        </action>
        <action name="recherche"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.RecherchePartenaire"
            method="recherche">
            <interceptor-ref name="scope">
                <param name="session">criteres</param>
            </interceptor-ref>
            <interceptor-ref name="scope">
                <param name="session">tablesStates</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">recherchePartenaire</result>
            <result name="input" type="tiles">recherchePartenaireError</result>
            <result name="error" type="tiles">recherchePartenaireError</result>
            <result name="success.xml" type="dispatcher">
                <param name="location">/WEB-INF/xml-jsp/partenaire/recherchePartenaire.jsp</param>
            </result>
        </action>
        <action name="retourRecherche"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.RecherchePartenaire"
            method="recherche">
            <interceptor-ref name="scope">
                <param name="session">criteres</param>
            </interceptor-ref>
            <interceptor-ref name="scope">
                <param name="session">tablesStates</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <interceptor-ref name="store">
                <param name="operationMode">RETRIEVE</param>
            </interceptor-ref>
            <result name="success" type="tiles">recherchePartenaire</result>
            <result name="input" type="tiles">recherchePartenaireError</result>
            <result name="error" type="tiles">recherchePartenaireError</result>
            <result name="success.xml" type="dispatcher">
                <param name="location">/WEB-INF/xml-jsp/partenaire/recherchePartenaire.jsp</param>
            </result>
        </action>
        <action name="initFiltrage"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.RecherchePartenaire">
            <interceptor-ref name="scope">
                <param name="session">criteres</param>
            </interceptor-ref>
            <result name="error" type="tiles">recherchePartenaireError</result>
            <result name="success" type="redirectAction">
                <param name="actionName">recherche</param>
                <param name="resetTableau">true</param>
            </result>
        </action>

        <action name="exportExcelPartenaires"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.RecherchePartenaire"
            method="exporterPatenairesExcel">
            <interceptor-ref name="scope">
                <param name="session">criteres</param>
            </interceptor-ref>
            <interceptor-ref name="scope">
                <param name="session">tablesStates</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="chain">
                <param name="actionName">exportExcelGenerique</param>
                <param name="namespace">/dyn/tech</param>
             </result>
            <result name="input" type="tiles">recherchePartenaireError</result>
            <result name="error" type="tiles">recherchePartenaireError</result>
        </action>
        
        <action name="exportCsvPartenaires"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.RecherchePartenaire"
            method="exporterPatenairesCsv">
            <interceptor-ref name="scope">
                <param name="session">criteres</param>
            </interceptor-ref>
            <interceptor-ref name="scope">
                <param name="session">tablesStates</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="csv" />
            <result name="input" type="tiles">recherchePartenaireError</result>
            <result name="error" type="tiles">recherchePartenaireError</result>
        </action>
        
        <!-- FICHE PARTENAIRE -->
        <action name="initFichePartenaire"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="initFichePartenaire">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">fichePartenaire</result>
            <result name="error" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
        </action>
        <action name="cancelFichePartenaire"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
        </action>

        <action name="initEditionPartenaire"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="initEditionPartenaire">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="scope">
                <param name="session">partenaireEnCours</param>
                <param name="type">start</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">ficheEditionPartenaire</result>
            <result name="error" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
        </action>
        <action name="reloadEditionPartenaire"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="reloadFichePartenaire">
            <interceptor-ref name="scope">
                <param name="session">partenaireEnCours</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">ficheEditionPartenaire</result>
            <result name="success.xml" type="dispatcher">
                <param name="location">/WEB-INF/xml-jsp/partenaire/listerVilles.jsp</param>
            </result>
            <result name="error" type="tiles">ficheEditionPartenaireError</result>
            <result name="input" type="tiles">ficheEditionPartenaireError</result>
        </action>
        <action name="reloadNationalite*"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="reloadListeNationalite">
            <interceptor-ref name="scope">
                <param name="session">partenaireEnCours</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">fiche{1}Partenaire</result>
            <result name="error" type="tiles">fiche{1}PartenaireError</result>
            <result name="input" type="tiles">fiche{1}PartenaireError</result>
            <result name="success.json" type="jackson"><param name="root">listeNation</param></result>
            <result name="error.json" type="jackson"><param name="root">listeNation</param></result>
            <result name="input.json" type="jackson"><param name="root">listeNation</param></result>
        </action>
        <action name="edition"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="modifierPartenaire">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="scope">
                <param name="session">partenaireEnCours</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
            <result name="error" type="tiles">ficheEditionPartenaireError</result>
            <result name="input" type="tiles">ficheEditionPartenaireError</result>
        </action>

        <action name="initAjoutPartenaire"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="initEditionPartenaire">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="scope">
                <param name="session">partenaireEnCours</param>
                <param name="type">start</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">ficheAjoutPartenaire</result>
            <result name="error" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
        </action>
        <action name="reloadAjoutPartenaire"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="reloadFichePartenaire">
            <interceptor-ref name="scope">
                <param name="session">partenaireEnCours</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">ficheAjoutPartenaire</result>
            <result name="success.xml" type="dispatcher">
                <param name="location">/WEB-INF/xml-jsp/partenaire/listerVilles.jsp</param>
            </result>
            <result name="error" type="tiles">ficheAjoutPartenaireError</result>
            <result name="input" type="tiles">ficheAjoutPartenaireError</result>
        </action>
        <action name="ajout"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="ajouterPartenaire">
            <interceptor-ref name="scope">
                <param name="session">partenaireEnCours</param>
            </interceptor-ref>
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="redirectAction">
                <param name="actionName">initEditionProduitsPartenaire</param>
                <param name="idPartenaire">${idPartenaire}</param>
                
            </result>
            <result name="error" type="tiles">ficheAjoutPartenaireError</result>
            <result name="input" type="tiles">ficheAjoutPartenaireError</result>
        </action>
        
        <action name="initEditionProduitsPartenaire"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="initEditionPartenaire">
            <interceptor-ref name="store">
                <param name="operationMode">RETRIEVE</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">ficheEditionProduitsPartenaire</result>
            <result name="error" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
        </action>
         

        <action name="supprimerPartenaire"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="supprimerPartenaire">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
            <result name="error" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
        </action>

        <action name="supprEnMassePartenaire"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.GestionPartenaire"
            method="supprimerPartenaire">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
            <result name="error" type="redirectAction">
                <param name="actionName">retourRecherche</param>
            </result>
        </action>
        

        <!-- ARBORESCENCE PARTENAIRE -->
        <action name="arborescence"
            class="fr.gouv.diplomatie.applitutoriel.web.action.partenaire.ArborescencePartenaire">
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">arborescencePartenaire</result>
        </action>
    </package>

    <package name="secteur" namespace="/dyn/protected/administration/secteur"
        extends="struts-hornet-applitutoriel">

        <action name="liste"
            class="fr.gouv.diplomatie.applitutoriel.web.action.administration.secteur.Liste">
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="tiles">listeSecteursEdit</result>
        </action>
        <action name="retourListe"
            class="fr.gouv.diplomatie.applitutoriel.web.action.administration.secteur.Liste">
            <interceptor-ref name="applitutoriel-stack" />
            <interceptor-ref name="store">
                <param name="operationMode">RETRIEVE</param>
            </interceptor-ref>
            <result name="success" type="tiles">listeSecteursEdit</result>
        </action>
        <action name="initAjout"
            class="fr.gouv.diplomatie.applitutoriel.web.action.administration.secteur.Ajout">
            <interceptor-ref name="applitutoriel-stack" />
            <result type="tiles">ajoutSecteur</result>
        </action>
        <action name="ajout"
            class="fr.gouv.diplomatie.applitutoriel.web.action.administration.secteur.Ajout"
            method="ajouter">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="redirectAction">
                <param name="actionName">retourListe</param>
            </result>
            <result name="input" type="tiles">ajoutSecteur</result>
            <result name="error" type="tiles">ajoutSecteur</result>
            <result name="success.xml" type="dispatcher">
                <param name="location">/WEB-INF/xml-jsp/administration/secteur/editionSecteur.jsp</param>
            </result>
        </action>
        <action name="initEdition"
            class="fr.gouv.diplomatie.applitutoriel.web.action.administration.secteur.Edition">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="input" type="redirectAction">
                <param name="actionName">retourListe</param>
            </result>
            <result name="success" type="tiles">editionSecteur</result>
        </action>
        <action name="edition"
            class="fr.gouv.diplomatie.applitutoriel.web.action.administration.secteur.Edition"
            method="editer">
            <interceptor-ref name="applitutoriel-stack" />
            <result name="input" type="tiles">editionSecteur</result>
            <result name="error" type="tiles">editionSecteur</result>
            <result name="success" type="redirectAction">
                <param name="actionName">retourListe</param>
            </result>
            <result name="success.xml" type="dispatcher">
                <param name="location">/WEB-INF/xml-jsp/administration/secteur/editionSecteur.jsp</param>
            </result>
        </action>
        <action name="suppression"
            class="fr.gouv.diplomatie.applitutoriel.web.action.administration.secteur.Suppression">
            <interceptor-ref name="store">
                <param name="operationMode">STORE</param>
            </interceptor-ref>
            <interceptor-ref name="applitutoriel-stack" />
            <result name="success" type="redirectAction">
                <param name="actionName">retourListe</param>
            </result>
            <result name="error" type="redirectAction">
                <param name="actionName">retourListe</param>
            </result>
            <result name="input" type="redirectAction">
                <param name="actionName">retourListe</param>
            </result>
        </action>
    </package>

    <!-- Contact -->
    <package name="contact" namespace="/dyn/protected/contact"
        extends="struts-hornet-hornetserver">
        <action name="formContact"
            class="fr.gouv.diplomatie.applitutoriel.web.action.contact.ContactAction"
            method="initContact">
            <result name="success" type="tiles">contact</result>
            <result name="error" type="tiles">contactError</result>
        </action>
        <action name="envoi"
            class="fr.gouv.diplomatie.applitutoriel.web.action.contact.ContactAction"
            method="envoiMail">
            <result name="success" type="redirectAction">
                <param name="actionName">formContact</param>
            </result>
            <result name="error" type="tiles">contactError</result>
            <result name="input" type="tiles">contactError</result>
        </action>
    </package>

    <!-- Authentification -->
    <package name="protectedrealm" namespace="/dyn/protectedrealm"
        extends="struts-hornet-hornetserver">
        <action name="login">
            <result name="success" type="tiles">login</result>
        </action>
    </package>
</struts>