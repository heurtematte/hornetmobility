YUI.add("hornet-validatorform",function(f){function e(h,g){e.superclass.constructor.call(this,h,g);this._inlineErrorMessage=("inlineErrorMessage" in g)&&g.inlineErrorMessage;this.callbackDisplayMessage=null;this.callbackPostValidateForm=null;if(("callbackDisplayMessage" in g)&&f.Lang.isFunction(g.callbackDisplayMessage)){this.callbackDisplayMessage=g.callbackDisplayMessage;this.callbackDisplayMessageScope=g.callbackDisplayMessageScope;}if(("callbackPostValidateForm" in g)&&f.Lang.isFunction(g.callbackPostValidateForm)){this.callbackPostValidateForm=g.callbackPostValidateForm;this.callbackPostValidateFormScope=g.callbackPostValidateFormScope;}}e.NAME="hornetFormMgrA11Y";e.ATTRS={};f.extend(e,f.FormManager,{displayMessage:function(i,j,h,g){if(this.callbackDisplayMessage!==null){this.callbackDisplayMessage.call(this.callbackDisplayMessageScope,i,j,h,g);}if(this._inlineErrorMessage){e.superclass.displayMessage.call(this,i,j,h,g);}},postValidateForm:function(){var g;g=true;if(this.callbackPostValidateForm!==null){g=this.callbackPostValidateForm.call(this.callbackPostValidateFormScope,this.callbackPostValidateForm);}return g;}});var b=f.Lang,a=b.isString;function c(h,g){this._errorBox=null;this._validation_error=null;this._anchorFields={};this._validators={};this._formValidators=[];this._anchorByFormValidators={};c.superclass.constructor.call(this,g);this.formManager=new e(h,f.merge(g,{callbackDisplayMessage:this._callbackDisplayMessage,callbackDisplayMessageScope:this,callbackPostValidateForm:this._callbackPostValidateForm,callbackPostValidateFormScope:this}));}c.NAME="hornetValidatorForm";c.ATTRS={errorBox:{value:".errorBox",setter:function(g){this._errorBox=f.one(g);}},validation_error:{value:"",setter:function(g){this._validation_error=g;},validator:a}};function d(g){var h;if(f.Lang.isString(g)){h=g.replace(/^#/,"");}else{if(g instanceof f.Node){h=g.get("id");}else{h=g.id;}}return h;}f.extend(c,f.Base,{clearForm:function(){if(!!this._errorBox){this._errorBox.setContent("");}this.formManager.clearMessages();},validateForm:function(){this.clearForm();var g=this.formManager.validateForm.apply(this.formManager,arguments);return g;},prepareForm:function(){this.formManager.getForm();},setErrorMessages:function(i,h,g){this.formManager.setErrorMessages.apply(this.formManager,arguments);if(!!g){this._anchorFields[i]=g;}},addErrorMessage:function(j,g,i,h){this.formManager.addErrorMessage.apply(this.formManager,arguments);if(!!h){this._anchorFields[j]=h;}},setDefaultValue:function(){this.formManager.setDefaultValue.apply(this.formManager,arguments);},addValidator:function(h,j,i){if(!!i){this._anchorFields[h]=i;}var l=d(h);var g=this._validators[l];var k=null;if(g===undefined){k=j;}else{k=new f.hornet.CompositeValidator(g,j);}this._validators[l]=k;this.formManager.setFunction(h,{fn:function(n,m){var o=k.validate(n,m);if(!o){this.formManager.displayMessage(m,k.getErrorMessage(),"error",true);}return o;},scope:this});},addFormValidator:function(h,g){this._formValidators.push(h);this._anchorByFormValidators[h]=g;},_callbackPostValidateForm:function(){var h=true;var g;for(g=0;g<this._formValidators.length&&h;g++){h=this._formValidators[g].validate();}if(!h){this.formManager.displayMessage(this._formValidators[g-1],this._formValidators[g-1].getErrorMessage(),"error",true);}else{h=h&&(f.fire("validate",{}));}return h;},_callbackDisplayMessage:function(j,h,m,o){if(!!this._errorBox){if(j){var n=null;if(j instanceof f.hornet.Validator){n=this._anchorByFormValidators[j];}else{var i=f.one(j).get("id");if(i&&this._anchorFields[i]){n=this._anchorFields[i];}}if(n){h='<a href="#'+n+'" >'+h+"</a>";}}var g=this._errorBox.one("> div");if(!g){g=f.Node.create("<div/>");this._errorBox.append(g);}var l=g.one("ul");if(!l){l=f.Node.create("<ul></ul>");g.append(l);}l.append("<li>"+h+"</li>");}if(!this.formManager.has_messages){try{j.focus();}catch(k){}}this.formManager.has_messages=true;},notifyErrors:function(g){if(f.Lang.isUndefined(g)){g=true;}if(!!this._errorBox){var j=this._errorBox.one("> div");if(j&&!!this._validation_error){j.prepend(f.Node.create(this._validation_error));}if(g){var i=f.guid(),h=f.Node.create('<a id="'+i+'" href="#'+i+'" tabindex="-1"></a>');this._errorBox.prepend(h);var k=this._errorBox.one("a");if(k){k.focus();}}}}});f.namespace("hornet").ValidatorForm=c;},"3.3.0",{skinnable:false,requires:["gallery-formmgr","base-base","hornet-validator-all"]});
