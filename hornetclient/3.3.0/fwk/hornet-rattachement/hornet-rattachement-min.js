YUI.add("hornet-rattachement",function(f){function n(B){if(B!=undefined){if(B==""||!window.RegExp){return function(D){return D==B;};}else{var C=new RegExp(B);return function(D){if(D==""){return true;}return C.test(D);};}}return function(D){return false;};}function x(C,B){if(C.text<B.text){return -1;}if(C.text>B.text){return 1;}return 0;}function A(E,D,C,B,H){var G=n(B);var F=n(H);z(E,D,C,function(I){return(I.selected&&!G(I.value)&&!F(I.value));});}function l(E,D,C,B,H){var G=n(B);var F=n(H);z(E,D,C,function(I){return(!G(I.value)&&!F(I.value));});}function z(C,E,H,K){var F=new Array();var B=new Array();var I=0;for(var D=0;D<C.length;D++){if(K(C.options[D])){var J=E.length++;E.options[J].text=C.options[D].text;E.options[J].value=C.options[D].value;}else{var G=new Object();G.text=C.options[D].text;G.value=C.options[D].value;F[I]=G;I++;}}for(var D=0;D<E.length;D++){var G=new Object();G.text=E.options[D].text;G.value=E.options[D].value;B[D]=G;}if(H){B.sort(x);}for(var D=0;D<E.length;D++){E.options[D].text=B[D].text;E.options[D].value=B[D].value;E.options[D].selected=false;}C.length=F.length;for(var D=0;D<F.length;D++){C.options[D].text=F[D].text;C.options[D].value=F[D].value;C.options[D].selected=false;}}function e(C,F,B){var G=n(B);for(var E=0;E<C.length;E++){var D=C.options[E];if((F=="key"&&!G(D.value))||(F=="text"&&!G(D.text))){D.selected=true;}else{D.selected=false;}}return false;}function g(B){for(var C=0;C<B.length;C++){if(B.options[C].value!=""){B.options[C].selected=true;}}return false;}function b(D,G,C){var E=D.options;var B=new Option(E[G].text,E[G].value,E[G].defaultSelected,E[G].selected);var F=new Option(E[C].text,E[C].value,E[C].defaultSelected,E[C].selected);E[G]=F;E[C]=B;}function d(D,E,C){var F=n(C);for(i=0;i<D.length;i++){if(D[i].selected){var B;if(i!=0&&!D[i-1].selected){if(E=="key"){B=D[i-1].value;}else{B=D[i-1].text;}if(!F(B)){b(D,i,i-1);}}}}}function u(D,E,C){var F=n(C);for(i=(D.length-1);i>=0;i--){if(D[i].selected){var B;if((i!=(D.length-1))&&!D[i+1].selected){if(E=="key"){B=D[i].value;}else{B=D[i].text;}if(!F(B)){b(D,i,i+1);}}}}}var o=f.ClassNameManager.getClassName,w=f.Lang.isString,c=f.Lang.isBoolean,y=f.Lang.isNumber,j=f.Lang.isArray,t=f.Lang.isValue,s=f.Node.create,q=f.Lang.sub,k="Rattachement",r="rattachement",p="form",h={panelContent:o(r,"panel"),selectedContent:o(r,"selected"),availableContent:o(r,"available"),actionsContent:o(r,"actions"),label:o(r,"label"),list:o(r,"data"),option:o(r,"entry"),actionButton:o(r,"action","button"),selectButton:o(r,"action","select"),deselectButton:o(r,"action","deselect"),selectAllButton:o(r,"action","select","all"),deselectAllButton:o(r,"action","deselect","all")},v=p;var a=function(B){return B.ancestor(v);};var m=function(){this._data={};m.superclass.constructor.apply(this,arguments);};m.NAME=k;m.HTML_PARSER={selectedListName:function(C){var B=C.one('input[type="checkbox"]');if(B){return B.get("name");}return"";},data:function(B){var C=B.one("ul"),E,D=[];if(C){E=C.all('input[type="checkbox"]');E.each(function(H){var I=H.get("value"),K=H.get("id"),G=H.get("checked"),F=K?B.one('label[for="'+K+'"]'):null,J=F?F.get("innerHTML"):"";D.push({value:I,text:J,selected:G});});C.remove();}return D;}};m.ATTRS={strings:{valueFn:function(){return f.Intl.get("hornet-rattachement");}},data:{value:{},validator:j},size:{value:15,setter:function(C,B){return parseInt(C,10);},validator:function(C,B){return(y(parseInt(C,10)));}},selectedContainer:{writeOnce:true},selectedListNode:{writeOnce:true},selectedListName:{validator:w},selectedLabel:{valueFn:"_defaultSelectedLabel",validator:w},selectedHeaderNode:{writeOnce:true},availableContainer:{writeOnce:true},availableListNode:{writeOnce:true},availableListName:{value:"",validator:w},availableLabel:{valueFn:"_defaultAvailableLabel",validator:w},availableHeaderNode:{writeOnce:true},actionsContainer:{writeOnce:true},allowSelectAction:{value:true,validator:c},selectActionLabel:{valueFn:"_defaultSelectActionLabel",validator:w},selectActionButton:{writeOnce:true},allowDeselectAction:{value:true,validator:c},deselectActionLabel:{valueFn:"_defaultDeselectActionLabel",validator:w},deselectActionButton:{writeOnce:true},allowSelectAllAction:{value:true,validator:c},selectAllActionLabel:{valueFn:"_defaultSelectAllActionLabel",validator:w},selectAllActionButton:{writeOnce:true},allowDeselectAllAction:{value:true,validator:c},deselectAllActionLabel:{valueFn:"_defaultDeselectAllActionLabel",validator:w},deselectAllActionButton:{writeOnce:true}};f.extend(m,f.Widget,{_defaultSelectedLabel:function(){return this.get("strings").selectedLabel;},_defaultAvailableLabel:function(){return this.get("strings").availableLabel;},_defaultSelectActionLabel:function(){return this.get("strings").selectActionLabel;},_defaultDeselectActionLabel:function(){return this.get("strings").deselectActionLabel;},_defaultSelectAllActionLabel:function(){return this.get("strings").selectAllActionLabel;},_defaultDeselectAllActionLabel:function(){return this.get("strings").deselectAllActionLabel;},TEMPLATES:{selectedContent:"<div class='"+h.panelContent+" "+h.selectedContent+"'></div>",availableContent:"<div class='"+h.panelContent+" "+h.availableContent+"'></div>",actionsContent:"<div class='"+h.panelContent+" "+h.actionsContent+"'></div>",label:"<label class='"+h.label+"' for='{forInputId}'></label>",list:"<select class='"+h.list+"' name='{inputName}' id='{inputId}' size='{size}' multiple='multiple'></select>",option:"<option class='"+h.option+"' value='{value}'>{text}</option>",action:"<span class='"+h.actionButton+"'></span>",actionButton:"<span class='{actionClassName}'><span class='yui-button'><span class='first-child'><button type='button'>{value}</button></span></span>"},renderUI:function(){var L=this.get("contentBox"),W=this.get("selectedContent"),aa=this.get("availableContent"),I=this.get("actionsContent"),ag=this.get("data"),R=this.get("size"),J;if(!t(aa)){aa=s(this.TEMPLATES.availableContent);L.append(aa);this.set("availableContent",aa);}else{aa.addClass(h.availableContent);
}if(!t(I)){I=s(this.TEMPLATES.actionsContent);L.append(I);this.set("actionsContent",I);}else{I.addClass(h.actionsContent);}if(!t(W)){W=s(this.TEMPLATES.selectedContent);L.append(W);this.set("selectedContent",W);}else{W.addClass(h.selectedContent);}var M=this.get("availableListNode"),Z=this.get("availableHeaderNode"),X=this.get("availableLabel"),ad=this.get("availableListName"),P=f.guid(ad);if(!t(Z)){Z=s(q(this.TEMPLATES.label,{forInputId:P}));aa.append(Z);this.set("availableHeaderNode",Z);}else{Z.addClass(h.label);}Z.setContent(X);if(!t(M)){M=s(q(this.TEMPLATES.list,{inputName:ad,inputId:P,size:R}));aa.append(M);this.set("availableListNode",M);}else{M.addClass(h.list);}M.setContent("");f.Array.each(ag,function(ai){if(!ai.selected){J=s(q(this.TEMPLATES.option,ai));M.appendChild(J);}},this);var S=this.get("selectedHeaderNode"),U=this.get("selectedListNode"),G=this.get("selectedLabel"),ah=this.get("selectedListName"),V=f.guid(ah);if(!t(S)){S=s(q(this.TEMPLATES.label,{forInputId:V}));W.append(S);this.set("selectedHeaderNode",S);}else{S.addClass(h.label);}S.setContent(G);if(!t(U)){U=s(q(this.TEMPLATES.list,{inputName:ah,inputId:V,size:R}));W.append(U);this.set("selectedListNode",U);}else{U.addClass(h.list);}U.setContent("");f.Array.each(ag,function(ai){if(!!ai.selected){J=s(q(this.TEMPLATES.option,ai));U.appendChild(J);}},this);var O=this.get("selectActionButton"),ac=this.get("selectActionLabel"),T=this.get("allowSelectAction"),H;if(!t(O)){if(T){H=s(this.TEMPLATES.action);O=s(q(this.TEMPLATES.actionButton,{actionClassName:h.selectButton,value:ac}));H.append(O);I.append(H);this.set("selectActionButton",O);}}else{if(T){O.addClass(h.selectButton);}else{O.remove();}}var N=this.get("deselectActionButton"),Y=this.get("deselectActionLabel"),C=this.get("allowDeselectAction"),E;if(!t(N)){if(C){E=s(this.TEMPLATES.action);N=s(q(this.TEMPLATES.actionButton,{actionClassName:h.deselectButton,value:Y}));E.append(N);I.append(E);this.set("deselectActionButton",N);}}else{if(C){N.addClass(h.deselectButton);}else{N.remove();}}var Q=this.get("selectAllActionButton"),ab=this.get("selectAllActionLabel"),F=this.get("allowSelectAllAction"),K;if(!t(Q)){if(F){K=s(this.TEMPLATES.action);Q=s(q(this.TEMPLATES.actionButton,{actionClassName:h.selectAllButton,value:ab}));K.append(Q);I.append(K);this.set("selectAllActionButton",Q);}}else{if(F){Q.addClass(h.selectAllButton);}else{Q.remove();}}var B=this.get("deselectAllActionButton"),ae=this.get("deselectAllActionLabel"),af=this.get("allowDeselectAllAction"),D;if(!t(B)){if(af){D=s(this.TEMPLATES.action);B=s(q(this.TEMPLATES.actionButton,{actionClassName:h.deselectAllButton,value:ae}));D.append(B);I.append(D);this.set("deselectAllActionButton",B);}}else{if(af){B.addClass(h.deselectAllButton);}else{B.remove();}}},_submitHandler:function(B){var C=this.get("selectedListNode");g(C.getDOMNode());return true;},_clickSelectHandler:function(C){var D=this.get("selectedListNode"),B=this.get("availableListNode");A(B.getDOMNode(),D.getDOMNode(),true);},_clickDeselectHandler:function(C){var D=this.get("selectedListNode"),B=this.get("availableListNode");A(D.getDOMNode(),B.getDOMNode(),true);},_clickSelectAllHandler:function(C){var D=this.get("selectedListNode"),B=this.get("availableListNode");l(B.getDOMNode(),D.getDOMNode(),true);},_clickDeselectAllHandler:function(C){var D=this.get("selectedListNode"),B=this.get("availableListNode");l(D.getDOMNode(),B.getDOMNode(),true);},bindUI:function(){var F=this.get("selectedListNode"),B=this.get("selectActionButton"),E=this.get("deselectActionButton"),G=this.get("selectAllActionButton"),D=this.get("deselectAllActionButton"),C=a(F);if(C){C.on("submit",this._submitHandler,this);}if(B){B.on("click",this._clickSelectHandler,this);}if(E){E.on("click",this._clickDeselectHandler,this);}if(G){G.on("click",this._clickSelectAllHandler,this);}if(D){D.on("click",this._clickDeselectAllHandler,this);}}});f.namespace("hornet").rattachement=m;},"3.3.0",{requires:["widget-base","widget-htmlparser"],lang:["fr"],skinnable:true});
